<?xml version="1.0"?>
<openerp>
<data>

	<template id="report_sale_order_document">
		<!-- COVER -->	
		<div class="header" id="header_cover"> </div>
		<div class="page">
			<div id="cover" class="col-md-12 col-xs-12">
				<img src="/logo.png" class="img"/>
				<br/>
				<h2>SALE ORDER NÂº <span t-field="o.name"/></h2>
				<!--h2>FOR</h2>
				<h2>{{TT1}}</h2-->
				<br/>
				<h4>CLIENT:</h4>
				<h2 t-field="o.partner_id.name" />
				<span class="pull-right" t-field="o.date_order" t-field-options='{"format": "dd/MM/yy"}'/>
			</div>
		</div>
		<div class="footer col-md-12 col-xs-12">
			<t t-call="sale_order_chapters.generic_footer"/>
		</div>
		
		<!-- ORDER SALE PAGE -->
		<t t-call="sale_order_chapters.external_layout">
			<div class="page">
				<table class="col-md-12 col-xs-12 table-chapter">
					<thead>
						<tr>
							<th class="col-md-6 col-xs-6 text-center">CONCEPT</th>
							<th class="col-md-2 col-xs-2 text-center">Uds.</th>
							<th class="col-md-2 col-xs-2 text-center">Price</th>
							<th class="col-md-2 col-xs-2 text-center">TOTAL</th>
						</tr>
					</thead>
					<tbody>
						<t t-set="chapters" t-value="request.env['sale_order_chapters.chapter'].search([('id', 'in', o.order_line.mapped('chapter_id.id'))], order='seq ASC')"/>
						<t t-set="numChapters" t-value="1" />
						<t t-foreach="chapters" t-as="c">
							<tr><td colspan="4" class="chapter-title"><strong t-esc="'%d. %s' % (numChapters, c.name.upper())" /></td></tr>
							<t t-set="lines_r" t-value="request.env['sale.order.line'].search([('order_id','=',o.id),('chapter_id', '=', c.id)])"/>
							<t t-set="numLines" t-value="1"/>
							<tr t-foreach="o.order_line" t-as="l">
								<td><strong t-esc="'%d.%d.- %s %s' % (numChapters, numLines, l.product_id.uom_id.name, l.product_id.name)"/><br/><t t-esc="l.product_id.description_sale"/></td>
								<td class="text-center" style="vertical-align:middle;"><strong t-esc="'%d Ud.' % l.product_uom_qty"/></td>
								<td class="text-center" style="vertical-align:middle;"><strong><span t-field="l.price_unit" t-field-options='{"widget": "monetary", "display_currency": "o.currency_id"}'/>/Ud.</strong></td>
								<td class="text-center" style="vertical-align:middle;"><strong t-field="l.price_subtotal" t-field-options='{"widget": "monetary", "display_currency": "o.currency_id"}' /></td>
								<t t-set="numLines" t-value="numLines+1"/>
							</tr>
							<t t-set="numChapters" t-value="numChapters+1" />
						</t>
						<tr>
							<td colspan="3"><strong>SALE ORDER TOTAL</strong></td>	
							<td class="text-center" style="vertical-align:middle;"><strong t-field="o.amount_untaxed" t-field-options='{"widget": "monetary", "display_currency": "o.currency_id"}' /></td>
						</tr>
					</tbody>
				</table>
			</div>
		</t>
	</template> 

</data>
</openerp>
